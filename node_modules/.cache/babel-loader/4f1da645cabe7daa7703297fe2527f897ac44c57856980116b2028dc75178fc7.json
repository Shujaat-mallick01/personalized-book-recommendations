{"ast":null,"code":"import React,{useState}from'react';import{Upload,Image,X}from'lucide-react';import{saveCustomBookCover,removeCustomBookCover,hasCustomCover}from'../../utils/helpers';import'./BookCoverUpload.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const BookCoverUpload=_ref=>{let{book,onCoverUpdate}=_ref;const[isUploading,setIsUploading]=useState(false);const[preview,setPreview]=useState(null);const[hasCustom,setHasCustom]=useState(hasCustomCover(book.id));React.useEffect(()=>{setHasCustom(hasCustomCover(book.id));},[book.id]);const handleFileSelect=event=>{const file=event.target.files[0];if(!file)return;if(!file.type.startsWith('image/')){alert('Please select an image file');return;}if(file.size>5*1024*1024){alert('File size must be less than 5MB');return;}setIsUploading(true);const reader=new FileReader();reader.onload=e=>{const imageUrl=e.target.result;setPreview(imageUrl);const success=saveCustomBookCover(book.id,imageUrl);if(success){setHasCustom(true);if(onCoverUpdate){onCoverUpdate(book.id,imageUrl);}}setIsUploading(false);};reader.readAsDataURL(file);};const removeCover=()=>{const success=removeCustomBookCover(book.id);if(success){setPreview(null);setHasCustom(false);if(onCoverUpdate){onCoverUpdate(book.id,null);}}};return/*#__PURE__*/_jsx(\"div\",{className:\"book-cover-upload\",children:/*#__PURE__*/_jsx(\"div\",{className:\"upload-area\",children:preview||hasCustom?/*#__PURE__*/_jsxs(\"div\",{className:\"preview-container\",children:[/*#__PURE__*/_jsx(\"img\",{src:preview||(hasCustom?JSON.parse(localStorage.getItem('customBookCovers')||'{}')[book.id]:null),alt:\"Cover preview\",className:\"cover-preview\"}),/*#__PURE__*/_jsx(\"button\",{className:\"remove-cover\",onClick:removeCover,children:/*#__PURE__*/_jsx(X,{size:16})})]}):/*#__PURE__*/_jsxs(\"label\",{className:\"upload-label\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:handleFileSelect,className:\"upload-input\",disabled:isUploading}),/*#__PURE__*/_jsxs(\"div\",{className:\"upload-content\",children:[/*#__PURE__*/_jsx(Upload,{size:32}),/*#__PURE__*/_jsx(\"span\",{children:isUploading?'Uploading...':'Upload Cover Image'}),/*#__PURE__*/_jsx(\"small\",{children:\"JPG, PNG up to 5MB\"})]})]})})});};export default BookCoverUpload;","map":{"version":3,"names":["React","useState","Upload","Image","X","saveCustomBookCover","removeCustomBookCover","hasCustomCover","jsx","_jsx","jsxs","_jsxs","BookCoverUpload","_ref","book","onCoverUpdate","isUploading","setIsUploading","preview","setPreview","hasCustom","setHasCustom","id","useEffect","handleFileSelect","event","file","target","files","type","startsWith","alert","size","reader","FileReader","onload","e","imageUrl","result","success","readAsDataURL","removeCover","className","children","src","JSON","parse","localStorage","getItem","alt","onClick","accept","onChange","disabled"],"sources":["C:/Users/T K/Desktop/personalized-book-recommendations/src/components/BookCoverUpload/index.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { Upload, Image, X } from 'lucide-react';\r\nimport { saveCustomBookCover, removeCustomBookCover, hasCustomCover } from '../../utils/helpers';\r\nimport './BookCoverUpload.css';\r\n\r\nconst BookCoverUpload = ({ book, onCoverUpdate }) => {\r\n  const [isUploading, setIsUploading] = useState(false);\r\n  const [preview, setPreview] = useState(null);\r\n  const [hasCustom, setHasCustom] = useState(hasCustomCover(book.id));\r\n\r\n  React.useEffect(() => {\r\n    setHasCustom(hasCustomCover(book.id));\r\n  }, [book.id]);\r\n\r\n  const handleFileSelect = (event) => {\r\n    const file = event.target.files[0];\r\n    if (!file) return;\r\n\r\n    if (!file.type.startsWith('image/')) {\r\n      alert('Please select an image file');\r\n      return;\r\n    }\r\n\r\n    if (file.size > 5 * 1024 * 1024) {\r\n      alert('File size must be less than 5MB');\r\n      return;\r\n    }\r\n\r\n    setIsUploading(true);\r\n    const reader = new FileReader();\r\n    reader.onload = (e) => {\r\n      const imageUrl = e.target.result;\r\n      setPreview(imageUrl);\r\n      \r\n      const success = saveCustomBookCover(book.id, imageUrl);\r\n      if (success) {\r\n        setHasCustom(true);\r\n        if (onCoverUpdate) {\r\n          onCoverUpdate(book.id, imageUrl);\r\n        }\r\n      }\r\n      setIsUploading(false);\r\n    };\r\n    \r\n    reader.readAsDataURL(file);\r\n  };\r\n\r\n  const removeCover = () => {\r\n    const success = removeCustomBookCover(book.id);\r\n    if (success) {\r\n      setPreview(null);\r\n      setHasCustom(false);\r\n      if (onCoverUpdate) {\r\n        onCoverUpdate(book.id, null);\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"book-cover-upload\">\r\n      <div className=\"upload-area\">\r\n        {preview || hasCustom ? (\r\n          <div className=\"preview-container\">\r\n            <img \r\n              src={preview || (hasCustom ? JSON.parse(localStorage.getItem('customBookCovers') || '{}')[book.id] : null)} \r\n              alt=\"Cover preview\" \r\n              className=\"cover-preview\" \r\n            />\r\n            <button className=\"remove-cover\" onClick={removeCover}>\r\n              <X size={16} />\r\n            </button>\r\n          </div>\r\n        ) : (\r\n          <label className=\"upload-label\">\r\n            <input\r\n              type=\"file\"\r\n              accept=\"image/*\"\r\n              onChange={handleFileSelect}\r\n              className=\"upload-input\"\r\n              disabled={isUploading}\r\n            />\r\n            <div className=\"upload-content\">\r\n              <Upload size={32} />\r\n              <span>{isUploading ? 'Uploading...' : 'Upload Cover Image'}</span>\r\n              <small>JPG, PNG up to 5MB</small>\r\n            </div>\r\n          </label>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default BookCoverUpload;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}