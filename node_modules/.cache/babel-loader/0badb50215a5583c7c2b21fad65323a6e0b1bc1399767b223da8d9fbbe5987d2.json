{"ast":null,"code":"import{useState,useEffect}from'react';import{useBooks}from'../../contexts/BookContext';import{useAuth}from'../../contexts/AuthContext';import SearchBar from'../../components/SearchBar';import BookCard from'../../components/BookCard';import GoogleSignIn from'../../components/GoogleSignIn';import{getPopularBooks,searchBooks}from'../../services/bookAPI';import{TrendingUp,Search,Filter,BookOpen}from'lucide-react';import'./Home.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Home=()=>{const{user}=useAuth();const{searchResults=[],loading,setLoading,setError,error,selectedGenresForHome=[]}=useBooks();const[popularBooks,setPopularBooks]=useState([]);const[genreBooks,setGenreBooks]=useState([]);useEffect(()=>{if(user){if(selectedGenresForHome&&selectedGenresForHome.length>0){loadGenreBasedPopularBooks();}else{loadPopularBooks();}}},[selectedGenresForHome,user]);const loadPopularBooks=async()=>{try{setLoading(true);const books=await getPopularBooks(12);setPopularBooks(books);setGenreBooks([]);}catch(error){setError('Failed to load popular books');console.error(error);}finally{setLoading(false);}};const loadGenreBasedPopularBooks=async()=>{try{setLoading(true);let allGenreBooks=[];for(const genre of selectedGenresForHome){try{const books=await searchBooks(\"subject:\".concat(genre),6);allGenreBooks=[...allGenreBooks,...books];}catch(error){console.error(\"Error loading \".concat(genre,\" books:\"),error);}}const uniqueBooks=allGenreBooks.filter((book,index,self)=>self.findIndex(b=>b.id===book.id)===index).sort(()=>Math.random()-0.5).slice(0,12);setGenreBooks(uniqueBooks);setPopularBooks([]);}catch(error){setError('Failed to load genre books');console.error(error);}finally{setLoading(false);}};const getPopularBooksTitle=()=>{if(selectedGenresForHome&&selectedGenresForHome.length>0){return\"\".concat(selectedGenresForHome.join(' & '),\" Books\");}return'Popular Books';};const getPopularBooksIcon=()=>{if(selectedGenresForHome&&selectedGenresForHome.length>0){return/*#__PURE__*/_jsx(Filter,{className:\"section-icon\",size:24});}return/*#__PURE__*/_jsx(TrendingUp,{className:\"section-icon\",size:24});};const booksToShow=selectedGenresForHome&&selectedGenresForHome.length>0?genreBooks:popularBooks;// Show only sign-in component if not authenticated\nif(!user){return/*#__PURE__*/_jsx(\"div\",{className:\"home\",children:/*#__PURE__*/_jsx(GoogleSignIn,{})});}// Show full home page if authenticated\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"home\",children:[/*#__PURE__*/_jsxs(\"section\",{className:\"hero\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Discover Your Next Great Read\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Search for books or explore our recommendations\"}),/*#__PURE__*/_jsx(SearchBar,{})]}),error&&/*#__PURE__*/_jsxs(\"div\",{className:\"error-message\",children:[/*#__PURE__*/_jsx(\"p\",{children:error}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setError(null),children:\"Dismiss\"})]}),searchResults.length>0&&/*#__PURE__*/_jsxs(\"section\",{className:\"search-results\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[/*#__PURE__*/_jsx(Search,{className:\"section-icon\",size:24}),\"Search Results (\",searchResults.length,\" found)\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"books-grid\",children:searchResults.map(book=>/*#__PURE__*/_jsx(BookCard,{book:book},book.id))})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"popular-books\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"section-header\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[getPopularBooksIcon(),getPopularBooksTitle()]}),selectedGenresForHome&&selectedGenresForHome.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"genre-indicator\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Based on your recommendations preferences\"}),/*#__PURE__*/_jsx(\"button\",{className:\"clear-genre-filter\",onClick:()=>window.location.href='/recommendations',children:\"Change Genres\"})]})]}),loading?/*#__PURE__*/_jsxs(\"div\",{className:\"loading\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading amazing books...\"})]}):booksToShow.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"books-grid\",children:booksToShow.slice(0,8).map(book=>/*#__PURE__*/_jsx(BookCard,{book:book},book.id))}):/*#__PURE__*/_jsxs(\"div\",{className:\"no-books-message\",children:[/*#__PURE__*/_jsx(BookOpen,{size:48}),/*#__PURE__*/_jsx(\"p\",{children:\"No books available\"})]})]})]});};export default Home;","map":{"version":3,"names":["useState","useEffect","useBooks","useAuth","SearchBar","BookCard","GoogleSignIn","getPopularBooks","searchBooks","TrendingUp","Search","Filter","BookOpen","jsx","_jsx","jsxs","_jsxs","Home","user","searchResults","loading","setLoading","setError","error","selectedGenresForHome","popularBooks","setPopularBooks","genreBooks","setGenreBooks","length","loadGenreBasedPopularBooks","loadPopularBooks","books","console","allGenreBooks","genre","concat","uniqueBooks","filter","book","index","self","findIndex","b","id","sort","Math","random","slice","getPopularBooksTitle","join","getPopularBooksIcon","className","size","booksToShow","children","onClick","map","window","location","href"],"sources":["C:/Users/T K/Desktop/personalized-book-recommendations/src/pages/Home/index.js"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { useBooks } from '../../contexts/BookContext';\r\nimport { useAuth } from '../../contexts/AuthContext';\r\nimport SearchBar from '../../components/SearchBar';\r\nimport BookCard from '../../components/BookCard';\r\nimport GoogleSignIn from '../../components/GoogleSignIn';\r\nimport { getPopularBooks, searchBooks } from '../../services/bookAPI';\r\nimport { TrendingUp, Search, Filter, BookOpen } from 'lucide-react';\r\nimport './Home.css';\r\n\r\nconst Home = () => {\r\n  const { user } = useAuth();\r\n  const { \r\n    searchResults = [], \r\n    loading, \r\n    setLoading, \r\n    setError, \r\n    error, \r\n    selectedGenresForHome = [] \r\n  } = useBooks();\r\n  \r\n  const [popularBooks, setPopularBooks] = useState([]);\r\n  const [genreBooks, setGenreBooks] = useState([]);\r\n\r\n  useEffect(() => {\r\n    if (user) {\r\n      if (selectedGenresForHome && selectedGenresForHome.length > 0) {\r\n        loadGenreBasedPopularBooks();\r\n      } else {\r\n        loadPopularBooks();\r\n      }\r\n    }\r\n  }, [selectedGenresForHome, user]);\r\n\r\n  const loadPopularBooks = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const books = await getPopularBooks(12);\r\n      setPopularBooks(books);\r\n      setGenreBooks([]);\r\n    } catch (error) {\r\n      setError('Failed to load popular books');\r\n      console.error(error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const loadGenreBasedPopularBooks = async () => {\r\n    try {\r\n      setLoading(true);\r\n      let allGenreBooks = [];\r\n\r\n      for (const genre of selectedGenresForHome) {\r\n        try {\r\n          const books = await searchBooks(`subject:${genre}`, 6);\r\n          allGenreBooks = [...allGenreBooks, ...books];\r\n        } catch (error) {\r\n          console.error(`Error loading ${genre} books:`, error);\r\n        }\r\n      }\r\n\r\n      const uniqueBooks = allGenreBooks\r\n        .filter((book, index, self) => self.findIndex(b => b.id === book.id) === index)\r\n        .sort(() => Math.random() - 0.5)\r\n        .slice(0, 12);\r\n\r\n      setGenreBooks(uniqueBooks);\r\n      setPopularBooks([]);\r\n    } catch (error) {\r\n      setError('Failed to load genre books');\r\n      console.error(error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const getPopularBooksTitle = () => {\r\n    if (selectedGenresForHome && selectedGenresForHome.length > 0) {\r\n      return `${selectedGenresForHome.join(' & ')} Books`;\r\n    }\r\n    return 'Popular Books';\r\n  };\r\n\r\n  const getPopularBooksIcon = () => {\r\n    if (selectedGenresForHome && selectedGenresForHome.length > 0) {\r\n      return <Filter className=\"section-icon\" size={24} />;\r\n    }\r\n    return <TrendingUp className=\"section-icon\" size={24} />;\r\n  };\r\n\r\n  const booksToShow = (selectedGenresForHome && selectedGenresForHome.length > 0) ? genreBooks : popularBooks;\r\n\r\n  // Show only sign-in component if not authenticated\r\n  if (!user) {\r\n    return (\r\n      <div className=\"home\">\r\n        <GoogleSignIn />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Show full home page if authenticated\r\n  return (\r\n    <div className=\"home\">\r\n      <section className=\"hero\">\r\n        <h2>Discover Your Next Great Read</h2>\r\n        <p>Search for books or explore our recommendations</p>\r\n        <SearchBar />\r\n      </section>\r\n\r\n      {error && (\r\n        <div className=\"error-message\">\r\n          <p>{error}</p>\r\n          <button onClick={() => setError(null)}>Dismiss</button>\r\n        </div>\r\n      )}\r\n      \r\n      {searchResults.length > 0 && (\r\n        <section className=\"search-results\">\r\n          <h3>\r\n            <Search className=\"section-icon\" size={24} />\r\n            Search Results ({searchResults.length} found)\r\n          </h3>\r\n          <div className=\"books-grid\">\r\n            {searchResults.map((book) => (\r\n              <BookCard key={book.id} book={book} />\r\n            ))}\r\n          </div>\r\n        </section>\r\n      )}\r\n      \r\n      <section className=\"popular-books\">\r\n        <div className=\"section-header\">\r\n          <h3>\r\n            {getPopularBooksIcon()}\r\n            {getPopularBooksTitle()}\r\n          </h3>\r\n          {selectedGenresForHome && selectedGenresForHome.length > 0 && (\r\n            <div className=\"genre-indicator\">\r\n              <span>Based on your recommendations preferences</span>\r\n              <button \r\n                className=\"clear-genre-filter\"\r\n                onClick={() => window.location.href = '/recommendations'}\r\n              >\r\n                Change Genres\r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n        \r\n        {loading ? (\r\n          <div className=\"loading\">\r\n            <div className=\"spinner\"></div>\r\n            <p>Loading amazing books...</p>\r\n          </div>\r\n        ) : booksToShow.length > 0 ? (\r\n          <div className=\"books-grid\">\r\n            {booksToShow.slice(0, 8).map((book) => (\r\n              <BookCard key={book.id} book={book} />\r\n            ))}\r\n          </div>\r\n        ) : (\r\n          <div className=\"no-books-message\">\r\n            <BookOpen size={48} />\r\n            <p>No books available</p>\r\n          </div>\r\n        )}\r\n      </section>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Home;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}